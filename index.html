<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MLB Rogue League</title>
  <style>
    :root {
      color-scheme: dark;
      --bg: #0b0f1e;
      --panel: #131a2b;
      --panel-light: #1b2440;
      --accent: #ffb703;
      --accent-2: #8ecae6;
      --danger: #ef476f;
      --success: #06d6a0;
      --muted: #8d99ae;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: "Inter", "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #1a2450 0%, #0b0f1e 50%, #070a12 100%);
      color: #f6f7fb;
      min-height: 100vh;
    }

    .app {
      max-width: 1300px;
      margin: 0 auto;
      padding: 32px 20px 60px;
    }

    header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 24px;
    }

    .title {
      font-size: 2.4rem;
      font-weight: 800;
      letter-spacing: 0.02em;
    }

    .subtitle {
      color: var(--muted);
      font-size: 0.95rem;
      margin-top: 4px;
    }

    .menu {
      display: grid;
      place-items: center;
      min-height: 70vh;
    }

    .menu-card {
      background: var(--panel);
      padding: 40px;
      border-radius: 20px;
      text-align: center;
      max-width: 520px;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
    }

    .menu-card h1 {
      font-size: 2.2rem;
      margin-bottom: 12px;
    }

    .menu-card p {
      color: var(--muted);
      margin-bottom: 24px;
      line-height: 1.6;
    }

    .btn-row {
      display: flex;
      gap: 12px;
      justify-content: center;
      flex-wrap: wrap;
    }

    button {
      background: var(--accent);
      border: none;
      padding: 12px 20px;
      border-radius: 10px;
      color: #1a1a1a;
      font-weight: 700;
      cursor: pointer;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    button.secondary {
      background: var(--panel-light);
      color: #f6f7fb;
    }

    button.ghost {
      background: transparent;
      border: 1px solid rgba(255, 255, 255, 0.2);
      color: #f6f7fb;
    }

    button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      box-shadow: none;
    }

    button:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: 0 12px 20px rgba(0, 0, 0, 0.3);
    }

    .layout {
      display: grid;
      grid-template-columns: 1.1fr 1.6fr 1fr;
      gap: 18px;
    }

    .panel {
      background: var(--panel);
      border-radius: 16px;
      padding: 16px;
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
    }

    .panel h3 {
      margin-bottom: 12px;
      font-size: 1.1rem;
      letter-spacing: 0.04em;
      text-transform: uppercase;
      color: var(--accent-2);
    }

    .stat-grid {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 12px;
    }

    .stat {
      background: var(--panel-light);
      padding: 12px;
      border-radius: 12px;
    }

    .stat span {
      display: block;
      color: var(--muted);
      font-size: 0.8rem;
    }

    .stat strong {
      font-size: 1.2rem;
    }

    .tag {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      background: rgba(142, 202, 230, 0.15);
      color: var(--accent-2);
      padding: 6px 10px;
      border-radius: 999px;
      font-size: 0.78rem;
    }

    .series-list {
      display: grid;
      gap: 12px;
    }

    .series-card {
      background: var(--panel-light);
      padding: 14px;
      border-radius: 12px;
      border: 1px solid transparent;
      cursor: pointer;
      transition: border 0.2s ease, transform 0.2s ease;
    }

    .series-card:hover {
      border-color: var(--accent);
      transform: translateY(-2px);
    }

    .series-card.active {
      border-color: var(--success);
      box-shadow: 0 0 0 1px var(--success);
    }

    .series-card h4 {
      margin-bottom: 6px;
    }

    .series-meta {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      font-size: 0.8rem;
      color: var(--muted);
    }

    .series-meta span {
      padding: 2px 8px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 999px;
    }

    .prep-actions {
      display: grid;
      gap: 10px;
    }

    .prep-card {
      padding: 10px;
      border-radius: 10px;
      border: 1px solid rgba(255, 255, 255, 0.12);
      background: rgba(255, 255, 255, 0.03);
      cursor: pointer;
    }

    .prep-card.selected {
      border-color: var(--accent);
      background: rgba(255, 183, 3, 0.12);
    }

    .log {
      background: #0a0f1d;
      border-radius: 12px;
      padding: 12px;
      max-height: 280px;
      overflow-y: auto;
      border: 1px solid rgba(255, 255, 255, 0.08);
      display: grid;
      gap: 8px;
    }

    .log-entry {
      font-size: 0.9rem;
      line-height: 1.4;
      padding-left: 10px;
      border-left: 3px solid var(--accent-2);
    }

    .log-entry.good { border-color: var(--success); }
    .log-entry.bad { border-color: var(--danger); }

    .roster-list {
      display: grid;
      gap: 10px;
    }

    .player {
      background: rgba(255, 255, 255, 0.04);
      border-radius: 10px;
      padding: 10px;
      border: 1px solid rgba(255, 255, 255, 0.08);
    }

    .player h5 {
      font-size: 0.95rem;
      margin-bottom: 4px;
    }

    .player .bars {
      display: grid;
      gap: 6px;
      margin-top: 8px;
    }

    .bar {
      height: 6px;
      background: rgba(255, 255, 255, 0.08);
      border-radius: 999px;
      overflow: hidden;
    }

    .bar span {
      display: block;
      height: 100%;
      background: var(--accent);
    }

    .panel footer {
      margin-top: 16px;
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }

    .status-line {
      display: flex;
      align-items: center;
      gap: 12px;
      flex-wrap: wrap;
      margin-bottom: 12px;
    }

    .scoreboard {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 12px;
      margin-bottom: 12px;
    }

    .score-card {
      background: var(--panel-light);
      border-radius: 12px;
      padding: 12px;
      text-align: center;
    }

    .score-card strong {
      font-size: 1.4rem;
      display: block;
    }

    .center-actions {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
      margin-top: 14px;
    }

    .notice {
      background: rgba(255, 183, 3, 0.1);
      border: 1px solid rgba(255, 183, 3, 0.3);
      padding: 10px;
      border-radius: 12px;
      font-size: 0.9rem;
      margin-bottom: 10px;
    }

    @media (max-width: 1100px) {
      .layout {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div class="app">
    <header>
      <div>
        <div class="title">MLB Rogue League</div>
        <div class="subtitle">Rebuild a modern MLB franchise through chaotic series, smart prep, and momentum swings.</div>
      </div>
      <div class="status-line" id="topStatus"></div>
    </header>

    <section class="menu" id="menu">
      <div class="menu-card">
        <h1>⚾ Build a Dynasty</h1>
        <p>Draft, prep, and outsmart your way through a 12-series gauntlet. Chain win streaks for perks and keep your roster healthy.</p>
        <div class="btn-row">
          <button id="newFranchiseBtn">Start New Franchise</button>
          <button class="secondary" id="continueBtn" disabled>Continue Run</button>
          <button class="ghost" id="wipeBtn">Reset Save</button>
        </div>
      </div>
    </section>

    <section id="game" style="display: none;">
      <div class="layout">
        <div class="panel">
          <h3>Front Office</h3>
          <div class="stat-grid" id="statGrid"></div>
          <div class="notice" id="goalNotice"></div>
          <div class="series-list" id="seriesList"></div>
          <footer>
            <button class="secondary" id="refreshSeriesBtn">Scout New Series (-$3000)</button>
            <button class="ghost" id="saveBtn">Save & Return</button>
          </footer>
        </div>

        <div class="panel">
          <h3>Gameplan</h3>
          <div class="scoreboard" id="scoreboard"></div>
          <div class="status-line" id="seriesStatus"></div>
          <div class="prep-actions" id="prepActions"></div>
          <div class="center-actions">
            <button id="playGameBtn">Play Next Game</button>
            <button class="secondary" id="clubhouseBtn">Clubhouse Boost</button>
            <button class="ghost" id="skipWeekBtn">Skip Week (Rest)</button>
          </div>
          <div class="log" id="log"></div>
        </div>

        <div class="panel">
          <h3>Roster</h3>
          <div class="roster-list" id="rosterList"></div>
          <footer>
            <button class="secondary" id="freeAgentBtn">Sign Free Agent ($8000)</button>
            <button class="ghost" id="analyticsBtn">Analytics Lab ($6000)</button>
          </footer>
        </div>
      </div>
    </section>
  </div>

  <script>
    const rosterNames = [
      "Avery Coleman", "Luis Nakamura", "Jaylen Cruz", "Marco Kim", "Theo Alvarez",
      "Brady Santos", "Dante Singh", "Kole Jefferson", "Rafael Moore", "Mason Tanaka",
      "Caleb Ruiz", "Eli Castillo", "Noah Reyes", "Bryce Velez", "Zion Park"
    ];

    const roles = ["SP", "RP", "INF", "INF", "OF", "OF", "C"];

    const ballparks = [
      { name: "Dodger Stadium", quirk: "Cool night air suppresses homers", swing: 0.95 },
      { name: "Wrigley Field", quirk: "Windy chaos boosts liners", swing: 1.05 },
      { name: "Truist Park", quirk: "Fast turf favors speed", speed: 1.1 },
      { name: "Oracle Park", quirk: "Deep gaps challenge defense", defense: 0.95 },
      { name: "Camden Yards", quirk: "Cozy porch helps righties", swing: 1.08 }
    ];

    const weather = [
      { name: "Clear", effect: 1.0 },
      { name: "Marine Layer", effect: 0.92 },
      { name: "Hot & Dry", effect: 1.08 },
      { name: "Rain Delay", effect: 0.9 },
      { name: "Crosswind", effect: 1.04 }
    ];

    const prepOptions = [
      {
        name: "Video Room Grind",
        effect: "+Contact, +Scouting, -Momentum",
        apply: (state) => {
          state.modifiers.contact += 0.08;
          state.modifiers.scout += 0.1;
          state.momentum = Math.max(0, state.momentum - 4);
        }
      },
      {
        name: "Bullpen Day",
        effect: "+Pitching, -Fatigue",
        apply: (state) => {
          state.modifiers.pitching += 0.1;
          state.teamFatigue = Math.max(0, state.teamFatigue - 6);
        }
      },
      {
        name: "Launch Angle Session",
        effect: "+Power, +Hype, +Fatigue",
        apply: (state) => {
          state.modifiers.power += 0.12;
          state.hype += 4;
          state.teamFatigue = Math.min(100, state.teamFatigue + 6);
        }
      },
      {
        name: "Day Off",
        effect: "+Rest, -Hype",
        apply: (state) => {
          state.teamFatigue = Math.max(0, state.teamFatigue - 12);
          state.hype = Math.max(0, state.hype - 6);
        }
      }
    ];

    let state = null;

    const dom = {
      menu: document.getElementById("menu"),
      game: document.getElementById("game"),
      newFranchiseBtn: document.getElementById("newFranchiseBtn"),
      continueBtn: document.getElementById("continueBtn"),
      wipeBtn: document.getElementById("wipeBtn"),
      statGrid: document.getElementById("statGrid"),
      seriesList: document.getElementById("seriesList"),
      prepActions: document.getElementById("prepActions"),
      rosterList: document.getElementById("rosterList"),
      log: document.getElementById("log"),
      scoreboard: document.getElementById("scoreboard"),
      seriesStatus: document.getElementById("seriesStatus"),
      topStatus: document.getElementById("topStatus"),
      refreshSeriesBtn: document.getElementById("refreshSeriesBtn"),
      playGameBtn: document.getElementById("playGameBtn"),
      clubhouseBtn: document.getElementById("clubhouseBtn"),
      skipWeekBtn: document.getElementById("skipWeekBtn"),
      freeAgentBtn: document.getElementById("freeAgentBtn"),
      analyticsBtn: document.getElementById("analyticsBtn"),
      saveBtn: document.getElementById("saveBtn"),
      goalNotice: document.getElementById("goalNotice")
    };

    const randomInt = (min, max) => Math.floor(Math.random() * (max - min + 1)) + min;
    const randomPick = (arr) => arr[randomInt(0, arr.length - 1)];

    const createRoster = () => {
      const roster = [];
      for (let i = 0; i < 9; i++) {
        roster.push({
          name: rosterNames[randomInt(0, rosterNames.length - 1)],
          role: roles[i % roles.length],
          batting: randomInt(55, 90),
          pitching: randomInt(45, 88),
          defense: randomInt(55, 90),
          speed: randomInt(50, 85),
          fatigue: randomInt(10, 25)
        });
      }
      return roster;
    };

    const createSeriesOptions = () => {
      const options = [];
      for (let i = 0; i < 3; i++) {
        const rating = randomInt(60, 92);
        const park = randomPick(ballparks);
        const condition = randomPick(weather);
        options.push({
          id: Date.now() + i,
          opponent: `${randomPick(["East", "Central", "West"])} Division ${randomPick(["Aces", "Scorch", "Voyagers", "Kings", "Wolves"])}`,
          rating,
          park,
          condition,
          reward: randomInt(4000, 9000),
          hype: randomInt(3, 8),
          risk: randomInt(4, 10),
          gamesPlayed: 0,
          wins: 0,
          losses: 0
        });
      }
      return options;
    };

    const freshState = () => ({
      season: 1,
      series: 1,
      wins: 0,
      losses: 0,
      bankroll: 22000,
      hype: 48,
      momentum: 0,
      teamFatigue: 22,
      modsUnlocked: 0,
      roster: createRoster(),
      modifiers: { power: 1, contact: 1, pitching: 1, defense: 1, scout: 1 },
      seriesOptions: createSeriesOptions(),
      activeSeriesId: null,
      prepChoiceIndex: null,
      log: ["New franchise launched. Target 7 series wins to reach the postseason."]
    });

    const saveGame = () => {
      localStorage.setItem("mlbRogueLeague", JSON.stringify(state));
      dom.continueBtn.disabled = false;
    };

    const loadGame = () => {
      const saved = localStorage.getItem("mlbRogueLeague");
      if (!saved) return null;
      return JSON.parse(saved);
    };

    const addLog = (message, tone = "") => {
      state.log.unshift({ message, tone });
      if (state.log.length > 15) state.log.pop();
    };

    const activeSeries = () => state.seriesOptions.find((series) => series.id === state.activeSeriesId);

    const averageStat = (stat) => {
      const total = state.roster.reduce((sum, player) => sum + player[stat], 0);
      return total / state.roster.length;
    };

    const applyPrepChoice = () => {
      if (state.prepChoiceIndex === null) return;
      prepOptions[state.prepChoiceIndex].apply(state);
    };

    const simulateGame = () => {
      const series = activeSeries();
      if (!series) return;

      const fatiguePenalty = (100 - state.teamFatigue) / 100;
      const parkSwing = series.park.swing || 1;
      const parkDefense = series.park.defense || 1;
      const parkSpeed = series.park.speed || 1;

      const offense = averageStat("batting") * state.modifiers.contact * state.modifiers.power * fatiguePenalty * parkSwing;
      const defense = averageStat("defense") * state.modifiers.defense * parkDefense;
      const pitching = averageStat("pitching") * state.modifiers.pitching * fatiguePenalty;
      const speed = averageStat("speed") * parkSpeed;

      const hypeBoost = 1 + state.hype / 200;
      const momentumBoost = 1 + state.momentum / 100;

      const playerRuns = Math.max(0, Math.round((offense / 18) * hypeBoost * momentumBoost + randomInt(0, 4)));
      const opponentRuns = Math.max(0, Math.round((series.rating / 18) * (2 - (pitching + defense) / 180) * series.condition.effect + randomInt(0, 3)));

      series.gamesPlayed += 1;
      if (playerRuns >= opponentRuns) {
        series.wins += 1;
        state.wins += 1;
        state.momentum += 6;
        state.hype = Math.min(100, state.hype + 4);
        addLog(`Win ${playerRuns}-${opponentRuns} vs ${series.opponent}.`, "good");
      } else {
        series.losses += 1;
        state.losses += 1;
        state.momentum = Math.max(-20, state.momentum - 5);
        state.hype = Math.max(0, state.hype - 3);
        addLog(`Loss ${playerRuns}-${opponentRuns} vs ${series.opponent}.`, "bad");
      }

      state.teamFatigue = Math.min(100, state.teamFatigue + randomInt(6, 12));

      if (series.gamesPlayed >= 3 || series.wins === 2 || series.losses === 2) {
        completeSeries(series);
      }
    };

    const completeSeries = (series) => {
      const wonSeries = series.wins > series.losses;
      if (wonSeries) {
        state.bankroll += series.reward;
        state.hype = Math.min(100, state.hype + series.hype);
        state.momentum += 5;
        addLog(`Series win! Earned $${series.reward} and ${series.hype} fan hype.`, "good");
      } else {
        state.bankroll = Math.max(0, state.bankroll - Math.round(series.reward / 2));
        state.momentum -= 4;
        addLog(`Series dropped. Lost half the payout and took a hit to momentum.`, "bad");
      }

      if (randomInt(1, 100) <= series.risk) {
        const player = randomPick(state.roster);
        player.fatigue = Math.min(100, player.fatigue + 20);
        addLog(`${player.name} picked up a nagging injury. Fatigue spiked.`, "bad");
      }

      state.series += 1;
      state.seriesOptions = createSeriesOptions();
      state.activeSeriesId = null;
      state.prepChoiceIndex = null;
      state.modifiers = { power: 1, contact: 1, pitching: 1, defense: 1, scout: 1 };

      if (state.series > 12) {
        addLog("Season complete! Reset to chase a new dynasty.", "good");
      }
    };

    const applyClubhouseBoost = () => {
      if (state.bankroll < 5000) {
        addLog("Need $5000 for a clubhouse boost.", "bad");
        return;
      }
      state.bankroll -= 5000;
      state.teamFatigue = Math.max(0, state.teamFatigue - 15);
      state.momentum += 3;
      addLog("Clubhouse boost: rested legs and a little extra swagger.", "good");
    };

    const signFreeAgent = () => {
      if (state.bankroll < 8000) {
        addLog("Not enough funds to sign a free agent.", "bad");
        return;
      }
      state.bankroll -= 8000;
      const player = {
        name: rosterNames[randomInt(0, rosterNames.length - 1)],
        role: randomPick(roles),
        batting: randomInt(65, 92),
        pitching: randomInt(55, 90),
        defense: randomInt(60, 92),
        speed: randomInt(55, 90),
        fatigue: randomInt(5, 20)
      };
      state.roster[randomInt(0, state.roster.length - 1)] = player;
      addLog(`Signed ${player.name} to reinforce the roster.`, "good");
    };

    const upgradeAnalytics = () => {
      if (state.bankroll < 6000) {
        addLog("Analytics lab needs $6000.", "bad");
        return;
      }
      state.bankroll -= 6000;
      state.modsUnlocked += 1;
      state.modifiers.contact += 0.05;
      state.modifiers.scout += 0.05;
      addLog("Analytics lab online: better scouting and contact boost.", "good");
    };

    const skipWeek = () => {
      state.teamFatigue = Math.max(0, state.teamFatigue - 18);
      state.hype = Math.max(0, state.hype - 4);
      addLog("Skipped a week for recovery. Fans cooled off.", "bad");
    };

    const refreshSeries = () => {
      if (state.bankroll < 3000) {
        addLog("Scouting refresh costs $3000.", "bad");
        return;
      }
      state.bankroll -= 3000;
      state.seriesOptions = createSeriesOptions();
      state.activeSeriesId = null;
      state.prepChoiceIndex = null;
      addLog("Scouting refreshed. New opponents available.", "good");
    };

    const renderTopStatus = () => {
      dom.topStatus.innerHTML = "";
      const tags = [
        `Season ${state.season}`,
        `Series ${state.series}/12`,
        `W-L ${state.wins}-${state.losses}`
      ];
      tags.forEach((label) => {
        const tag = document.createElement("div");
        tag.className = "tag";
        tag.textContent = label;
        dom.topStatus.appendChild(tag);
      });
    };

    const renderStats = () => {
      dom.statGrid.innerHTML = "";
      const stats = [
        { label: "Bankroll", value: `$${state.bankroll.toLocaleString()}` },
        { label: "Fan Hype", value: `${state.hype}` },
        { label: "Momentum", value: `${state.momentum}` },
        { label: "Team Fatigue", value: `${state.teamFatigue}` },
        { label: "Scouting Bonus", value: `+${Math.round(state.modifiers.scout * 100 - 100)}%` },
        { label: "Upgrades", value: `${state.modsUnlocked}` }
      ];
      stats.forEach((stat) => {
        const card = document.createElement("div");
        card.className = "stat";
        card.innerHTML = `<span>${stat.label}</span><strong>${stat.value}</strong>`;
        dom.statGrid.appendChild(card);
      });

      dom.goalNotice.textContent = state.series > 12
        ? "Season is over. Reset to start a new chase."
        : "Goal: Win at least 7 series to reach October.";
    };

    const renderSeriesList = () => {
      dom.seriesList.innerHTML = "";
      state.seriesOptions.forEach((series) => {
        const card = document.createElement("div");
        card.className = "series-card";
        if (series.id === state.activeSeriesId) {
          card.classList.add("active");
        }
        card.innerHTML = `
          <h4>${series.opponent}</h4>
          <div class="series-meta">
            <span>Rating ${series.rating}</span>
            <span>${series.park.name}</span>
            <span>${series.condition.name}</span>
            <span>Reward $${series.reward}</span>
          </div>
          <p style="margin-top:8px; color: var(--muted); font-size:0.85rem;">${series.park.quirk}</p>
        `;
        card.addEventListener("click", () => {
          state.activeSeriesId = series.id;
          state.prepChoiceIndex = null;
          render();
        });
        dom.seriesList.appendChild(card);
      });
    };

    const renderPrep = () => {
      dom.prepActions.innerHTML = "";
      const series = activeSeries();
      if (!series) {
        dom.prepActions.innerHTML = "<div class=\"notice\">Select a series on the left to set your gameplan.</div>";
        return;
      }

      const info = document.createElement("div");
      info.className = "notice";
      info.textContent = `Opposing ${series.opponent} (${series.rating}) at ${series.park.name}. ${series.condition.name} conditions.`;
      dom.prepActions.appendChild(info);

      prepOptions.forEach((option, index) => {
        const card = document.createElement("div");
        card.className = "prep-card";
        if (state.prepChoiceIndex === index) {
          card.classList.add("selected");
        }
        card.innerHTML = `<strong>${option.name}</strong><p style="color:var(--muted); font-size:0.85rem;">${option.effect}</p>`;
        card.addEventListener("click", () => {
          state.prepChoiceIndex = index;
          render();
        });
        dom.prepActions.appendChild(card);
      });
    };

    const renderRoster = () => {
      dom.rosterList.innerHTML = "";
      state.roster.forEach((player) => {
        const card = document.createElement("div");
        card.className = "player";
        card.innerHTML = `
          <h5>${player.name} · ${player.role}</h5>
          <div style="color: var(--muted); font-size:0.8rem;">BAT ${player.batting} | PIT ${player.pitching} | DEF ${player.defense} | SPD ${player.speed}</div>
          <div class="bars">
            <div class="bar"><span style="width:${player.batting}%"></span></div>
            <div class="bar"><span style="width:${player.pitching}%"></span></div>
            <div class="bar"><span style="width:${player.defense}%"></span></div>
          </div>
        `;
        dom.rosterList.appendChild(card);
      });
    };

    const renderLog = () => {
      dom.log.innerHTML = "";
      state.log.forEach((entry) => {
        const row = document.createElement("div");
        row.className = `log-entry ${entry.tone || ""}`;
        row.textContent = entry.message;
        dom.log.appendChild(row);
      });
    };

    const renderScoreboard = () => {
      const series = activeSeries();
      dom.scoreboard.innerHTML = "";
      const cards = [
        { label: "Series Record", value: series ? `${series.wins}-${series.losses}` : "-" },
        { label: "Games Played", value: series ? `${series.gamesPlayed}/3` : "-" },
        { label: "Next Payout", value: series ? `$${series.reward}` : "-" }
      ];
      cards.forEach((cardData) => {
        const card = document.createElement("div");
        card.className = "score-card";
        card.innerHTML = `<span style="color:var(--muted); font-size:0.8rem;">${cardData.label}</span><strong>${cardData.value}</strong>`;
        dom.scoreboard.appendChild(card);
      });

      dom.seriesStatus.innerHTML = "";
      if (series) {
        const tags = [
          `Risk ${series.risk}%`,
          `Hype +${series.hype}`,
          `${series.park.quirk}`
        ];
        tags.forEach((tagText) => {
          const tag = document.createElement("div");
          tag.className = "tag";
          tag.textContent = tagText;
          dom.seriesStatus.appendChild(tag);
        });
      }
    };

    const render = () => {
      renderTopStatus();
      renderStats();
      renderSeriesList();
      renderPrep();
      renderRoster();
      renderLog();
      renderScoreboard();

      dom.playGameBtn.disabled = !activeSeries() || state.series > 12;
      dom.refreshSeriesBtn.disabled = state.series > 12;
      dom.skipWeekBtn.disabled = state.series > 12;
    };

    dom.newFranchiseBtn.addEventListener("click", () => {
      state = freshState();
      dom.menu.style.display = "none";
      dom.game.style.display = "block";
      render();
      saveGame();
    });

    dom.continueBtn.addEventListener("click", () => {
      const loaded = loadGame();
      if (!loaded) return;
      state = loaded;
      dom.menu.style.display = "none";
      dom.game.style.display = "block";
      render();
    });

    dom.wipeBtn.addEventListener("click", () => {
      localStorage.removeItem("mlbRogueLeague");
      dom.continueBtn.disabled = true;
    });

    dom.refreshSeriesBtn.addEventListener("click", () => {
      refreshSeries();
      render();
      saveGame();
    });

    dom.playGameBtn.addEventListener("click", () => {
      if (!activeSeries()) return;
      applyPrepChoice();
      simulateGame();
      render();
      saveGame();
    });

    dom.clubhouseBtn.addEventListener("click", () => {
      applyClubhouseBoost();
      render();
      saveGame();
    });

    dom.skipWeekBtn.addEventListener("click", () => {
      skipWeek();
      render();
      saveGame();
    });

    dom.freeAgentBtn.addEventListener("click", () => {
      signFreeAgent();
      render();
      saveGame();
    });

    dom.analyticsBtn.addEventListener("click", () => {
      upgradeAnalytics();
      render();
      saveGame();
    });

    dom.saveBtn.addEventListener("click", () => {
      saveGame();
      dom.game.style.display = "none";
      dom.menu.style.display = "grid";
    });

    const boot = () => {
      const saved = loadGame();
      dom.continueBtn.disabled = !saved;
    };

    boot();
  </script>
</body>
</html>
